<!-- <app-navigation /> -->
<!-- Główny kontener desktop -->
<div
  class="desktop"
  [attr.data-theme]="(isDarkMode$ | async) ? 'dark' : 'light'"
  (contextmenu)="displayContextMenu($event)"
>
  <right-click-context-menu #contextMenu></right-click-context-menu>
  <!-- Taskbar -->
  <div class="taskbar">
    <nav class="navbar">
      <header class="topnav w-100">
        <nav
          class="navbar navbar-expand-lg container-fluid"
          [ngClass]="
            (isDarkMode$ | async)
              ? 'navbar-dark bg-dark'
              : 'navbar-light bg-light'
          "
        >
          <div class="navbar-left">
            <ul class="navbar-nav">
              <!-- Dashboard -->
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle drop-arrow-none"
                  href="#"
                  id="topnav-dashboards"
                  data-bs-toggle="dropdown"
                >
                  <span class="menu-icon"
                    ><i class="ti ti-layout-dashboard"></i
                  ></span>
                  <span class="menu-text">Pulpit</span>
                  <div class="menu-arrow"></div>
                </a>
                <div class="dropdown-menu" aria-labelledby="topnav-dashboards">
                  <a
                    class="dropdown-item"
                    (click)="openCalculator(); $event.preventDefault()"
                  >
                    <i class="ti ti-home"></i> Panel główny</a
                  >
                  <a
                    class="dropdown-item"
                    (click)="openNotepad(); $event.preventDefault()"
                  >
                    <i class="ti ti-pencil"></i> Notatnik</a
                  >
                  <a
                    class="dropdown-item"
                    (click)="openCalculator(); $event.preventDefault()"
                  >
                    <i class="ti ti-chart-pie"></i> Raporty</a
                  >
                </div>
              </li>

              <!-- Zarządzanie -->
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle drop-arrow-none"
                  href="#"
                  id="topnav-management"
                  data-bs-toggle="dropdown"
                >
                  <span class="menu-icon"><i class="ti ti-settings"></i></span>
                  <span class="menu-text">Zarządzanie</span>
                  <div class="menu-arrow"></div>
                </a>
                <div class="dropdown-menu" aria-labelledby="topnav-management">
                  <a
                    class="dropdown-item"
                    (click)="openNotepad(); $event.preventDefault()"
                  >
                    <i class="ti ti-users"></i> Użytkownicy</a
                  >
                  <a
                    class="dropdown-item"
                    (click)="openCalculator(); $event.preventDefault()"
                  >
                    <i class="ti ti-lock"></i> Uprawnienia</a
                  >
                  <a
                    class="dropdown-item"
                    (click)="openNotepad(); $event.preventDefault()"
                  >
                    <i class="ti ti-settings"></i> Ustawienia</a
                  >
                </div>
              </li>

              <!-- Dokumenty -->
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle drop-arrow-none"
                  href="#"
                  id="topnav-documents"
                  data-bs-toggle="dropdown"
                >
                  <span class="menu-icon"><i class="ti ti-files"></i></span>
                  <span class="menu-text">Dokumenty</span>
                  <div class="menu-arrow"></div>
                </a>
                <div class="dropdown-menu" aria-labelledby="topnav-documents">
                  <a
                    class="dropdown-item"
                    (click)="openCalculator(); $event.preventDefault()"
                  >
                    <i class="ti ti-file-invoice"></i> Faktury</a
                  >
                  <a
                    class="dropdown-item"
                    (click)="openNotepad(); $event.preventDefault()"
                  >
                    <i class="ti ti-shopping-cart"></i> Zamówienia</a
                  >
                  <a
                    class="dropdown-item"
                    (click)="openCalculator(); $event.preventDefault()"
                  >
                    <i class="ti ti-file-contract"></i> Umowy</a
                  >
                </div>
              </li>

              <!-- Raporty -->
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle drop-arrow-none"
                  href="#"
                  id="topnav-reports"
                  data-bs-toggle="dropdown"
                >
                  <span class="menu-icon"><i class="ti ti-chart-bar"></i></span>
                  <span class="menu-text">Raporty</span>
                  <div class="menu-arrow"></div>
                </a>
                <div class="dropdown-menu" aria-labelledby="topnav-reports">
                  <a
                    class="dropdown-item"
                    (click)="openNotepad(); $event.preventDefault()"
                  >
                    <i class="ti ti-report-money"></i> Raporty sprzedaży</a
                  >
                  <a
                    class="dropdown-item"
                    (click)="openCalculator(); $event.preventDefault()"
                  >
                    <i class="ti ti-report"></i> Raporty finansowe</a
                  >
                  <a
                    class="dropdown-item"
                    (click)="openNotepad(); $event.preventDefault()"
                  >
                    <i class="ti ti-chart-dots"></i> Analityka</a
                  >
                  <a
                    class="dropdown-item"
                    (click)="openTwoWindows(); $event.preventDefault()"
                  >
                    <i class="ti ti-messages"></i> Otwórz 2 okna</a
                  >
                </div>
              </li>
            </ul>
          </div>

          <!-- Prawy pasek -->
          <div class="navbar-right">
            <app-open-windows-list
              [windows]="(windows$ | async) || []"
            ></app-open-windows-list>
            <app-notification-icon></app-notification-icon>
            <button class="theme-toggle" (click)="toggleTheme()">
              <i
                [class]="(isDarkMode$ | async) ? 'bi bi-sun' : 'bi bi-moon'"
              ></i>
            </button>
            <app-user-nav-icon></app-user-nav-icon>
          </div>
        </nav>
      </header>
    </nav>
  </div>
  <!-- Okna aplikacji -->
  <div class="windows-container">
    <app-window
      *ngFor="let window of (windows$ | async) || []; trackBy: trackById"
      [window]="window"
      [isDarkMode]="(isDarkMode$ | async) || false"
    >
    </app-window>
  </div>

  <!-- Agent -->
  <div class="agent-container">
    <app-agent></app-agent>
  </div>
</div>
